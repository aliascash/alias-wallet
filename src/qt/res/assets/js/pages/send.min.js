var sendPage;$((function(){sendPage=function(){function e(e){return e?2==e.at&&""===$("#send-balance .pay_to").val()&&($("#send-balance .pay_to").val(e.address).change(),$("#send-balance .pay_to").data("address",e.address)):$("#send-balance .pay_to").val($("#send-balance .pay_to").data("address")).change(),!0}function t(e){void 0===e&&(e=$(".show-coin-control .btn-cons").hasClass("active")),$("#coincontrol").toggle(e)}function n(){return $("div.recipient").length}function o(){$("#recipients").append(((0==n()?"":"<hr />")+s.replace(/recipient-template/g,"recipient[count]")).replace(/\[count\]/g,++p)),$("#recipient"+p.toString()+" [data-title]").tooltip(),$("#amount"+p.toString()).on("keydown",unit.keydown).on("paste",unit.paste),"undefined"!=typeof clientBridge&&clientBridge.userAction(["clearRecipients"])}function i(){$("#recipients").html(""),$("#send-balance .amount").val("0").change(),o(),e(),c()}function c(){numOfRecipients=0}function a(e,t){function n(){numOfRecipients++;var e=$(this).find(".pay_to"),t=$(this).find(".amount"),n=$(this).find(".narration").val();void 0===n&&(n=""),clientBridge.addRecipient(e.val(),$(this).find(".pay_to_label").val(),n,unit.parse(t.val(),$(this).find(".unit").val()),o)}if(void 0!==e)e&&i();else if(void 0!==t)t&&(numOfRecipients--,0==numOfRecipients&&clientBridge.sendCoins($("#coincontrol").is(":visible"),$("#change_address").val()));else{var o=r();clientBridge.userAction(["clearRecipients"]),$("#send-balance").is(":visible")?$("#send-balance").each(n):$("div.recipient").each(n)}}function l(t){var n=$("#send-main").is(":visible"),o=$("[name=transaction_type_from]:checked").val(),i=$("[name=transaction_type_to]:checked").val();console.log("OPEN"),console.log(o),t&&(t.target!==$("input#to_account_public")[0]&&t.target!==$("input#to_account_private")[0]?(i=n?o:"public"===o?"private":"public",$("input[name=transaction_type_to][value="+i+"]").prop("checked",!0)):n||(o="public"===i?"private":"public",$("input[name=transaction_type_from][value="+o+"]").prop("checked",!0)));var c=$("[name=transaction_type_to  ]:checked").val(),a=r();$("#spend_spec").toggle("public"===o),$("#spend_spectre").toggle("private"===o),$("#tx_ringsize").toggle("private"===o),$("#to_spec").toggle("public"===c),$("#to_spectre").toggle("private"===c),$("#to_balance").toggle(!n),$(".show-coin-control").toggle(a<1),sendPage.toggleCoinControl(a<0),$(".advanced_controls").toggle(!n),$("#add_recipient").toggle($("#send-main").is(":visible")),n||e()}function r(){var e="public"===$("[name=transaction_type_from]:checked").val(),t="public"===$("[name=transaction_type_to  ]:checked").val();return e?+!t:2+t}var s=$("#recipient-template")[0].outerHTML,p=0;return $("#recipient-template").remove(),{init:function(){t(!1),o(),l(),$(".advanced_controls").toggle(!1),$("#send [name^=transaction_type]").on("change",l),$("#send [data-toggle=tab]").on("shown.bs.tab",l)},initSendBalance:e,toggleCoinControl:t,addRecipient:o,addRecipientDetail:function(e,t,n,o){i();let c=e.length<76?"public":"private";$("input[name=transaction_type_from][value="+c+"]").prop("checked",!0),$("#recipient"+p.toString()+" .pay_to").val(e).change(),$("#recipient"+p.toString()+" .pay_to_label").val(t).change(),$("#recipient"+p.toString()+" .amount").val(o/1e8).change(),$("#recipient"+p.toString()+" .narration").val(n).change(),$("[href=#send]").click()},clearRecipients:i,removeRecipient:function(e){n()<=1?i():(0==(e=$(e)).next("hr").remove().length&&e.prev("hr").remove(),e.remove(),$("#tooltip").remove())},sendCoins:function(){c(),a()},update:a,updateCoinControl:function(){if($("#coincontrol").is(":visible")){for(var e=0,t=0;t<recipients;t++)e+=unit.parse($("#amount"+t).val());clientBridge.updateCoinControlAmount(e)}},updateCoinControlInfo:function(e,t,n,o,i,c,a,l){$("#coincontrol").is(":visible")&&($("#coincontrol_auto").toggle(0===e),$("#coincontrol_labels").toggle(e>0),e>0?($("#coincontrol_quantity").text(e),$("#coincontrol_amount").text(unit.format(t)),$("#coincontrol_fee").text(unit.format(n)),$("#coincontrol_afterfee").text(unit.format(o)),$("#coincontrol_bytes").text("~"+i).css("color",i>1e4?"red":null),$("#coincontrol_priority").text(c).css("color",0==c.indexOf("low")?"red":null),$("#coincontrol_low").text(a).toggle(l).css("color","yes"==a?"red":null),$("#coincontrol_change").text(unit.format(l)).toggle(l),$("label[for='coincontrol_low'],label[for='coincontrol_change']").toggle(l)):($("#coincontrol_quantity").text(""),$("#coincontrol_amount").text(""),$("#coincontrol_fee").text(""),$("#coincontrol_afterfee").text(""),$("#coincontrol_bytes").text(""),$("#coincontrol_priority").text(""),$("#coincontrol_low").text(""),$("#coincontrol_change").text("")))},changeTransactionType:l}}()}));
